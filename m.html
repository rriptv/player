<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>JW Player Stream</title>
    
    <script type="text/javascript" src="https://fle-rvd0i9o8-moo.com/player/jw8_26/jwplayer.js?v=5.0.2"></script>
    
    <script>
        // 2. Your Specific License Key
        jwplayer.key = 'eNFaXCjyURVoCCGiHp7HTQ3hDhE/AfL0g8VE1fRbL84=';
    </script>

    <style>
        html, body {
            width: 100% !important;
            height: 100% !important;
            overflow: hidden !important;
            background-color: #000 !important;
            margin: 0;
            padding: 0;
        }
        #player {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
        }
    </style>
</head>
<body>

    <div id="player"></div>

    <script type="text/javascript">
        // 4. URL PARSING LOGIC (Auto-detects keys)
        
        var currentUrl = window.location.href;
        var rawInput = "";
        
        // Extract everything strictly after "id=" to avoid breaking on special characters
        if (currentUrl.indexOf("id=") > -1) {
            rawInput = currentUrl.substring(currentUrl.indexOf("id=") + 3);
        }

        var streamUrl = "";
        var keyId = "";
        var key = "";

        if (rawInput) {
            
            // --- DETECT LINK FORMAT ---

            // FORMAT 1: Link contains "?|drmScheme=" (Complex format)
            if (rawInput.includes("?|drmScheme=")) {
                var parts = rawInput.split("?|drmScheme=");
                streamUrl = parts[0];
                
                // Parse the DRM part
                var rest = parts[1]; 
                if (rest.indexOf("drmLicense=") > -1) {
                    var licenseVal = rest.split("drmLicense=")[1];
                    // Clean up trailing params (get text before next &)
                    var keyString = licenseVal.split("&")[0];
                    
                    var keyParts = keyString.split(":");
                    if (keyParts.length === 2) {
                        keyId = keyParts[0];
                        key = keyParts[1];
                    }
                }
            } 
            // FORMAT 2: Link contains "|" (Simple format)
            else if (rawInput.includes("|")) {
                var parts = rawInput.split("|");
                var keyString = parts.pop(); // Assume last part is key
                streamUrl = parts.join("|"); // Join rest in case URL had pipes
                
                var keyParts = keyString.split(":");
                if (keyParts.length === 2) {
                    keyId = keyParts[0];
                    key = keyParts[1];
                }
            } 
            // FALLBACK: Just URL (No keys)
            else {
                streamUrl = rawInput;
            }

            // --- SETUP PLAYER ---
            
            var drmConfig = undefined;
            
            // Build ClearKey object dynamically if keys exist
            if (keyId && key) {
                var clearkeyObj = {};
                clearkeyObj[keyId] = key;
                drmConfig = {
                    clearkey: clearkeyObj
                };
            }

            jwplayer("player").setup({
                playlist: [{
                    file: streamUrl,
                    type: "dash",
                    drm: drmConfig
                }],
                width: "100%",
                height: "100%",
                autostart: true,
                mute: false,
                stretching: "exactfit",
                cast: {}
            });

        } else {
            console.log("No ID parameter found.");
        }
    </script>
</body>
</html>
