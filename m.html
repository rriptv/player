<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JW Player Stream</title>
    
    <script type="text/javascript" src="https://fle-rvd0i9o8-moo.com/player/jw8_26/jwplayer.js?v=5.0.2"></script>
    
    <script>
        // 2. Your License Key
        jwplayer.key = 'eNFaXCjyURVoCCGiHp7HTQ3hDhE/AfL0g8VE1fRbL84=';
    </script>

    <style>
        body { margin: 0; padding: 0; background-color: #000; overflow: hidden; }
        #player { width: 100%; height: 100vh; }
    </style>
</head>
<body>

<div id="player"></div>

<script>
    // 3. Robust URL Parameter Extraction (Bypasses browser encoding issues)
    var currentUrl = window.location.href;
    var rawInput = "";
    
    if (currentUrl.indexOf("id=") > -1) {
        // Grab everything strictly after "id="
        rawInput = currentUrl.substring(currentUrl.indexOf("id=") + 3);
    }

    var streamUrl = "";
    var keyId = "";
    var key = "";

    if (rawInput) {
        // --- DETECTION LOGIC ---

        // FORMAT 1: Complex Link (...?|drmScheme=clearkey&drmLicense=KID:KEY)
        if (rawInput.includes("?|drmScheme=")) {
            var parts = rawInput.split("?|drmScheme=");
            streamUrl = parts[0];
            
            // Parse the params part
            var rest = parts[1]; // e.g., "clearkey&drmLicense=kid:key"
            if (rest.indexOf("drmLicense=") > -1) {
                var licenseVal = rest.split("drmLicense=")[1];
                // Clean up any trailing '&' parameters
                var keyString = licenseVal.split("&")[0];
                
                var keyParts = keyString.split(":");
                if (keyParts.length === 2) {
                    keyId = keyParts[0];
                    key = keyParts[1];
                }
            }
        } 
        // FORMAT 2: Simple Link (...|KID:KEY)
        else if (rawInput.includes("|")) {
            var parts = rawInput.split("|");
            // The key is usually the last part
            var keyString = parts.pop();
            // Rejoin the rest just in case the URL had pipes
            streamUrl = parts.join("|"); 
            
            var keyParts = keyString.split(":");
            if (keyParts.length === 2) {
                keyId = keyParts[0];
                key = keyParts[1];
            }
        } 
        // FALLBACK: Just URL
        else {
            streamUrl = rawInput;
        }

        // --- PLAYER CONFIG ---
        
        var drmConfig = undefined;
        
        // Dynamically build the ClearKey object
        if (keyId && key) {
            var clearkeyObj = {};
            clearkeyObj[keyId] = key; // Assigns keyId as property name, key as value
            
            drmConfig = {
                clearkey: clearkeyObj
            };
        }

        jwplayer("player").setup({
            playlist: [{
                file: streamUrl,
                type: "dash",
                drm: drmConfig
            }],
            width: "100%",
            height: "100%",
            autostart: true,
            mute: false,
            stretching: "exactfit",
            // Add Cast support just in case
            cast: {} 
        });

    } else {
        // Error Message if no link provided
        document.body.innerHTML = '<h3 style="color:white; font-family:sans-serif; text-align:center; margin-top:20%">Please add ?id=YOUR_LINK to the URL</h3>';
    }
</script>

</body>
</html>
